<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>AminLogic QR</title>
<style>
:root {
  --bg1: #0b1220; --bg2:#111c33; --glass:rgba(255,255,255,0.06);
  --stroke: rgba(255,255,255,0.10); --text: rgba(255,255,255,0.92);
  --muted: rgba(255,255,255,0.55); --blue:#4ea8ff; --green:#46ffb3;
  --red:#ff5a7a; --radius:18px;
}
body{margin:0;padding:0;font-family:Arial,sans-serif;min-height:100vh;background:radial-gradient(circle at top,#1a2b52 0%,var(--bg1) 45%,#070b14 100%);color:var(--text);}
.container{max-width:520px;margin:auto;padding:16px;padding-bottom:90px;}
.topbar{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:var(--radius);background:linear-gradient(145deg,rgba(255,255,255,0.08),rgba(255,255,255,0.03));border:1px solid var(--stroke);}
.app-title{display:flex;align-items:center;gap:12px;}
.app-icon{width:46px;height:46px;border-radius:14px;border:1px solid rgba(255,255,255,0.12);}
.card{background:linear-gradient(145deg,rgba(255,255,255,0.08),rgba(255,255,255,0.03));border-radius:var(--radius);padding:18px;margin-bottom:14px;border:1px solid var(--stroke);}
.btn-row{display:flex;gap:12px;margin-top:14px;flex-wrap:wrap;}
button{border:none;padding:12px;border-radius:16px;cursor:pointer;flex:1;min-width:130px;}
.btn-blue{background:linear-gradient(135deg,rgba(78,168,255,0.95),rgba(78,168,255,0.55));color:#fff;}
.btn-green{background:linear-gradient(135deg,rgba(70,255,179,0.95),rgba(70,255,179,0.55));color:#052014;}
.btn-red{background:linear-gradient(135deg,rgba(255,90,122,0.95),rgba(255,90,122,0.55));color:#fff;}
.btn-dark{background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.10);color:rgba(255,255,255,0.85);}
.qr-box{position:relative;margin-top:16px;display:flex;justify-content:center;align-items:center;padding:16px;border-radius:18px;border:1px solid rgba(255,255,255,0.12);background:rgba(0,0,0,0.20);}
.share-btn{position:absolute;bottom:8px;right:8px;background:var(--blue);color:#fff;font-size:12px;padding:6px 10px;border-radius:12px;cursor:pointer;}
video{width:100%;border-radius:18px;margin-top:14px;}
.scan-result{position:relative;margin-top:14px;padding:14px;border-radius:16px;border:1px solid rgba(255,255,255,0.10);background:rgba(0,0,0,0.18);}
.tabs{position:fixed;bottom:0;left:0;right:0;background:rgba(8,12,20,0.82);backdrop-filter:blur(18px);padding:12px;display:flex;gap:12px;}
.tab-btn{flex:1;max-width:180px;text-align:center;padding:12px;border-radius:18px;font-weight:900;cursor:pointer;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.10);color:rgba(255,255,255,0.65);}
.tab-btn.active{background:rgba(78,168,255,0.16);border:1px solid rgba(78,168,255,0.22);color:rgba(255,255,255,0.92);}
</style>
</head>
<body>
<div class="container">
  <div class="topbar">
    <div class="app-title">
      <img src="icon-512.png" class="app-icon" />
      <div>
        <h1>AminLogic QR</h1>
        <p>Generate • Scan • Share • History</p>
      </div>
    </div>
    <div class="badge" id="statusBadge">Ready</div>
  </div>

  <!-- Generator -->
  <div id="tabGenerator" class="tab-content">
    <div class="card">
      <h2>QR Generator</h2>
      <textarea id="qrText" placeholder="Enter text, URL, etc"></textarea>
      <div class="btn-row">
        <button class="btn-blue" onclick="generateQR()">Generate</button>
        <button class="btn-dark" onclick="clearGenerator()">Clear</button>
      </div>
      <div class="qr-box">
        <div id="qrcode"></div>
        <div class="share-btn" onclick="shareQR()">Share</div>
      </div>
      <div class="btn-row">
        <button class="btn-green" onclick="saveQR()">Save</button>
        <button class="btn-dark" onclick="copyText()">Copy</button>
      </div>
    </div>
  </div>

  <!-- Scanner -->
  <div id="tabScanner" class="tab-content" style="display:none;">
    <div class="card">
      <h2>QR Scanner</h2>
      <div class="btn-row">
        <button class="btn-blue" onclick="startScanner()">Start Scan</button>
        <button class="btn-red" onclick="stopScanner()">Stop</button>
      </div>
      <video id="video" autoplay playsinline></video>
      <div class="scan-result">
        <h3>Scan Result</h3>
        <p id="scanResultText">No scan yet...</p>
        <div class="share-btn" onclick="shareScan()">Share</div>
      </div>
      <div class="btn-row">
        <button class="btn-green" onclick="saveScan()">Save</button>
        <button class="btn-dark" onclick="copyScan()">Copy</button>
      </div>
    </div>
  </div>

  <!-- History -->
  <div id="tabHistory" class="tab-content" style="display:none;">
    <div class="card">
      <h2>History</h2>
      <div id="historyList"></div>
      <div class="btn-row">
        <button class="btn-red" onclick="clearHistory()">Clear All</button>
      </div>
    </div>
  </div>
</div>

<div class="tabs">
  <div class="tab-btn active" onclick="switchTab('generator')">Generator</div>
  <div class="tab-btn" onclick="switchTab('scanner')">Scanner</div>
  <div class="tab-btn" onclick="switchTab('history')">History</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://unpkg.com/jsqr/dist/jsQR.js"></script>
<script>
let qr, videoStream=null, scanning=false, scanInterval=null;
function setStatus(txt){document.getElementById('statusBadge').innerText=txt;}
window.onload=function(){
  qr=new QRCode(document.getElementById('qrcode'),{text:'https://aminlogic.com',width:220,height:220,colorDark:'#fff',colorLight:'transparent',correctLevel:QRCode.CorrectLevel.H});
  loadHistory();
};
function switchTab(tab){
  ['tabGenerator','tabScanner','tabHistory'].forEach(id=>document.getElementById(id).style.display='none');
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  if(tab==='generator'){document.getElementById('tabGenerator').style.display='block';document.querySelectorAll('.tab-btn')[0].classList.add('active'); setStatus('Generator');}
  if(tab==='scanner'){document.getElementById('tabScanner').style.display='block';document.querySelectorAll('.tab-btn')[1].classList.add('active'); setStatus('Scanner');}
  if(tab==='history'){document.getElementById('tabHistory').style.display='block';document.querySelectorAll('.tab-btn')[2].classList.add('active'); setStatus('History');loadHistory();}
}

// Generator
function generateQR(){const text=document.getElementById('qrText').value.trim();if(!text){setStatus('Enter text');return;}document.getElementById('qrcode').innerHTML='';qr=new QRCode(document.getElementById('qrcode'),{text,width:220,height:220,colorDark:'#fff',colorLight:'transparent',correctLevel:QRCode.CorrectLevel.H});setStatus('Generated');}
function clearGenerator(){document.getElementById('qrText').value='';document.getElementById('qrcode').innerHTML='';setStatus('Cleared');}
function copyText(){const text=document.getElementById('qrText').value.trim();if(!text){setStatus('Nothing to copy');return;}navigator.clipboard.writeText(text);setStatus('Copied');}
function saveQR(){const text=document.getElementById('qrText').value.trim();if(!text){setStatus('Nothing to save');return;}let h=JSON.parse(localStorage.getItem('aminlogic_qr_history')||'[]');h.unshift({type:'Generated',value:text,time:new Date().toLocaleString()});localStorage.setItem('aminlogic_qr_history',JSON.stringify(h));setStatus('Saved');}
function shareQR(){const text=document.getElementById('qrText').value.trim();if(!text){setStatus('Nothing to share');return;}if(navigator.share){navigator.share({title:'QR Code',text}).then(()=>setStatus('Shared')).catch(()=>setStatus('Share failed'));}else alert('Copy or save to share');}

// Scanner
async function startScanner(){
  try{
    const video=document.getElementById('video');
    videoStream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}});
    video.srcObject=videoStream;
    scanning=true;
    setStatus('Scanning...');
    scanInterval=setInterval(()=>{
      if(!scanning) return;
      const canvas=document.createElement('canvas');
      canvas.width=video.videoWidth; canvas.height=video.videoHeight;
      const ctx=canvas.getContext('2d');
      ctx.drawImage(video,0,0,canvas.width,canvas.height);
      const code=jsQR(ctx.getImageData(0,0,canvas.width,canvas.height).data,canvas.width,canvas.height);
      if(code){document.getElementById('scanResultText').innerText=code.data; setStatus('QR Found!'); stopScanner();}
    },500);
  }catch(e){setStatus('Camera permission required'); alert('Allow camera to scan QR codes.');}
}
function stopScanner(){scanning=false; if(scanInterval){clearInterval(scanInterval); scanInterval=null;} if(videoStream){videoStream.getTracks().forEach(t=>t.stop()); videoStream=null;}document.getElementById('video').srcObject=null;}
function saveScan(){const r=document.getElementById('scanResultText').innerText.trim();if(!r||r==='No scan yet...'){setStatus('Nothing to save');return;}let h=JSON.parse(localStorage.getItem('aminlogic_qr_history')||'[]');h.unshift({type:'Scanned',value:r,time:new Date().toLocaleString()});localStorage.setItem('aminlogic_qr_history',JSON.stringify(h));setStatus('Saved');}
function copyScan(){const r=document.getElementById('scanResultText').innerText.trim();if(!r||r==='No scan yet...'){setStatus('Nothing to copy');return;}navigator.clipboard.writeText(r);setStatus('Copied');}
function shareScan(){const r=document.getElementById('scanResultText').innerText.trim();if(!r||r==='No scan yet...'){setStatus('Nothing to share');return;}if(navigator.share){navigator.share({title:'Scanned QR',text:r}).then(()=>setStatus('Shared')).catch(()=>setStatus('Share failed'));}else alert('Copy or save to share');}

// History
function loadHistory(){const list=document.getElementById('historyList');list.innerHTML='';let h=JSON.parse(localStorage.getItem('aminlogic_qr_history')||'[]');if(h.length===0){list.innerHTML="<p style='text-align:center;color:#888;'>No history yet.</p>";return;}h.forEach((item,i)=>{const div=document.createElement('div');div.className='history-item';div.innerHTML=`<strong>[${item.type}] ${item.time}</strong><span>${item.value}</span><div class="history-actions"><button onclick="copyHistory(${i})">Copy</button><button onclick="shareHistory(${i})">Share</button></div>`;list.appendChild(div);});}
function clearHistory(){if(confirm('Clear all history?')){localStorage.removeItem('aminlogic_qr_history');loadHistory();setStatus('History cleared');}}
function copyHistory(i){let h=JSON.parse(localStorage.getItem('aminlogic_qr_history')||'[]');navigator.clipboard.writeText(h[i].value);setStatus('Copied');}
function shareHistory(i){let h=JSON.parse(localStorage.getItem('aminlogic_qr_history')||'[]');if(navigator.share){navigator.share({title:'QR History',text:h[i].value}).then(()=>setStatus('Shared')).catch(()=>setStatus('Share failed'));}else alert('Copy or save to share');}
</script>
</body>
</html>
